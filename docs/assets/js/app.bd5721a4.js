(function(e){function t(t){for(var a,o,s=t[0],c=t[1],l=t[2],d=0,h=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&h.push(i[o][0]),i[o]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);u&&u(t);while(h.length)h.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],a=!0,s=1;s<n.length;s++){var c=n[s];0!==i[c]&&(a=!1)}a&&(r.splice(t--,1),e=o(o.s=n[0]))}return e}var a={},i={app:0},r=[];function o(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=a,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(n,a,function(t){return e[t]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var a=n("64a9"),i=n.n(a);i.a},"38c1":function(e,t,n){"use strict";var a=n("cb15"),i=n.n(a);i.a},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var a=n("a026"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("Home")],1)},r=[],o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[n("h1",[e._v("Photos")]),n("camera")],1)},s=[],c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"camera"},[n("div",{staticClass:"action-group"},[n("button",{attrs:{id:"start-stream"},on:{click:e.start}},[e._v("Start")]),n("button",{attrs:{id:"stop-stream"},on:{click:e.stop}},[e._v("Stop")]),n("button",{attrs:{id:"snapshot"},on:{click:e.snapshot}},[e._v("Snapshot")]),n("button",{attrs:{id:"download"},on:{click:e.download}},[e._v("Download")]),n("select",{staticClass:"u-full-width",attrs:{id:"video-select"}})]),e._m(0),e._m(1),n("div",{attrs:{id:"gallery"}}),n("a",{attrs:{href:"https://github.com/rebeccapeltz/photos",title:"View source for this page on GitHub",id:"viewSource"}},[e._v("\n    View\n    source on GitHub\n  ")])])},l=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"container"}},[n("video",{attrs:{playsinline:"",autoplay:""}}),n("canvas")])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form",{staticClass:"upload-form",attrs:{id:"upload-form"}},[n("input",{attrs:{type:"text",name:"cloud-name",value:"picturecloud7",placeholder:"Enter cloud name"}}),n("input",{attrs:{type:"text",name:"preset",value:"bp_test_1",placeholder:"Enter upload preset"}}),n("button",{attrs:{type:"submit"}},[e._v("Upload")])])}],u=(n("28a5"),n("ac4d"),n("8a81"),n("ac6a"),n("96cf"),n("3b8d")),d=n("d225"),h=n("b0b4"),p=function(){function e(t,n,a){var i=this;Object(d["a"])(this,e),this.currentImage=null,this.cloudName=null,this.preset=null,this.defaultCloudName="picturecloud7",this.defaultPreset="bp_test_1",this.video=t,this.canvas=n,this.select=a,this.fileData=null,this.constraints=null,this.currentStream=null,this.devices=[],navigator.mediaDevices.enumerateDevices().then(function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.forEach(function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("videoinput"!==t.kind){e.next=3;break}return e.next=3,i.devices.push(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:console.log("populate select"),i.populateDeviceSelect();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.error("Camera init:",e)}))}return Object(h["a"])(e,[{key:"populateDeviceSelect",value:function(){this.select.innerHTML="";var e=document.createElement("option");e.label="Select Camera",this.select.appendChild(e);var t=1,n=!0,a=!1,i=void 0;try{for(var r,o=this.devices[Symbol.iterator]();!(n=(r=o.next()).done);n=!0){var s=r.value,c=document.createElement("option");c.value=s.deviceId;var l=s.label||"Camera ".concat(t++),u=document.createTextNode(l);c.appendChild(u),this.select.appendChild(c)}}catch(d){a=!0,i=d}finally{try{n||null==o.return||o.return()}finally{if(a)throw i}}this.select.label=this.devices[0].label,this.select.value=this.devices[0].deviceId,this.turnOnDevice()}},{key:"setCloudName",value:function(e){this.cloudName=e}},{key:"setPreset",value:function(e){this.preset=e}},{key:"setConstraints",value:function(){console.log("set constraints");var e={};console.log(this.select.value,this.select.label),""===this.select.value?e.facingMode="environment":e.deviceId={exact:this.select.value},this.constraints={video:e,audio:!1}}},{key:"turnOnDevice",value:function(){var e=this;console.log("camera on"),this.turnAllDevicesOff(),this.setConstraints(),navigator.mediaDevices.getUserMedia(this.constraints).then((function(t){window.stream=t,e.video.srcObject=t,e.currentStream=t})).catch((function(e){console.error(e)}))}},{key:"turnAllDevicesOff",value:function(){console.log("camera off"),this.video.pause(),this.currentStream&&this.currentStream.getTracks().forEach((function(e){e.stop()})),this.video.srcObject=null,this.video.removeAttribute("src"),this.video.load(),this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height)}},{key:"snapshot",value:function(){console.log("snapshot"),this.canvas.width=this.video.videoWidth,this.canvas.height=this.video.videoHeight,this.canvas.getContext("2d").drawImage(this.video,0,0,this.canvas.width,this.canvas.height),this.fileData=this.canvas.toDataURL("image/jpeg")}},{key:"download",value:function(){if(this.fileData){console.log("download"),this.canvas.width=this.video.videoWidth,this.canvas.height=this.video.videoHeight,this.canvas.getContext("2d").drawImage(this.video,0,0,this.canvas.width,this.canvas.height);var e=document.createElement("a");e.href=this.fileData,e.textContent="photo",e.target="_blank",e.download="photo.jpeg",document.querySelector("body").append(e),e.click()}}},{key:"upload",value:function(){console.log("upload");var e="https://api.cloudinary.com/v1_1/".concat(this.cloudName,"/upload"),t=new XMLHttpRequest,n=new FormData;t.open("POST",e,!0),t.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.onreadystatechange=function(e){if(4==t.readyState&&200==t.status){var n=JSON.parse(t.responseText),a=n.secure_url,i=a.split("/");i.splice(-3,0,"w_150,c_scale");var r=new Image;r.src=i.join("/"),r.alt=n.public_id}},n.append("upload_preset",this.preset),n.append("tags","browser_upload"),n.append("file",this.fileData),t.send(n)}}]),e}(),v=function(){function e(){Object(d["a"])(this,e)}return Object(h["a"])(e,[{key:"getSingleInstance",value:function(e,t,n){return new p(e,t,n)}}]),e}(),f=new v,m={name:"Camera",data:function(){return{camera:null}},methods:{snapshot:function(){this.camera.snapshot()},stop:function(){this.camera.turnAllDevicesOff()},start:function(){this.camera.turnOnDevice()},download:function(){this.camera.download()}},mounted:function(){var e=document.querySelector("video"),t=document.querySelector("canvas"),n=document.querySelector("#video-select");this.camera=f.getSingleInstance(e,t,n)}},g=m,b=n("2877"),y=Object(b["a"])(g,c,l,!1,null,"3332afa0",null),w=y.exports,_={name:"Home",props:{msg:String},components:{camera:w}},O=_,S=(n("38c1"),Object(b["a"])(O,o,s,!1,null,"29c24a63",null)),k=S.exports,x={name:"app",components:{Home:k}},j=x,C=(n("034f"),Object(b["a"])(j,i,r,!1,null,null,null)),D=C.exports,E=n("8c4f");a["a"].use(E["a"]);var H=new E["a"]({routes:[{path:"/",name:"home",component:k}]});a["a"].config.productionTip=!1,new a["a"]({router:H,render:function(e){return e(D)}}).$mount("#app")},"64a9":function(e,t,n){},cb15:function(e,t,n){}});
//# sourceMappingURL=app.bd5721a4.js.map