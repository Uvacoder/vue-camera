(function(e){function t(t){for(var n,r,i=t[0],l=t[1],c=t[2],d=0,h=[];d<i.length;d++)r=i[d],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&h.push(s[r][0]),s[r]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);u&&u(t);while(h.length)h.shift()();return o.push.apply(o,c||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],n=!0,i=1;i<a.length;i++){var l=a[i];0!==s[l]&&(n=!1)}n&&(o.splice(t--,1),e=r(r.s=a[0]))}return e}var n={},s={app:0},o=[];function r(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=n,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var u=l;o.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"034f":function(e,t,a){"use strict";var n=a("64a9"),s=a.n(n);s.a},"56d7":function(e,t,a){"use strict";a.r(t);a("cadf"),a("551c"),a("f751"),a("097d");var n=a("a026"),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("div",[a("b-navbar",{staticClass:"nav-bg",attrs:{toggleable:"lg",type:"dark"}},[a("b-navbar-brand",{attrs:{href:"#"}},[e._v("Vue Camera")]),a("b-navbar-toggle",{attrs:{target:"nav-collapse"}}),a("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[a("b-navbar-nav",[a("b-nav-item",{attrs:{to:"/"}},[e._v("Camera")]),a("b-nav-item",{attrs:{to:"/gallery",disabled:0===e.cloudname.length||0===e.preset.length}},[e._v("Gallery")])],1),a("b-navbar-nav",{staticClass:"ml-auto"},[a("b-nav-item",[a("div",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-prevent-closing",modifiers:{"modal-prevent-closing":!0}}],staticClass:"settings"},[a("i",{staticClass:"fas fa-cog"})]),a("b-modal",{ref:"modal",attrs:{id:"modal-prevent-closing",title:"Cloudinary Upload Info"},on:{show:e.resetModal,hidden:e.resetModal,ok:e.handleOk}},[a("form",{ref:"form",on:{submit:function(t){return t.stopPropagation(),t.preventDefault(),e.handleSubmit(t)}}},[a("b-form-group",{attrs:{state:e.cloudnameState,label:"Cloudname","label-for":"cloud-name-input","invalid-feedback":"Cloudname is required"}},[a("b-form-input",{attrs:{id:"cloud-name-input",state:e.cloudnameState,required:""},model:{value:e.cloudname,callback:function(t){e.cloudname=t},expression:"cloudname"}})],1),a("b-form-group",{attrs:{state:e.presetState,label:"Preset","label-for":"preset-input","invalid-feedback":"Preset is required"}},[a("b-form-input",{attrs:{id:"preset-input",state:e.presetState,required:""},model:{value:e.preset,callback:function(t){e.preset=t},expression:"preset"}})],1),a("b-form-group",[a("b-form-checkbox",{attrs:{id:"clearsettings",name:"clearsettings",value:"true","unchecked-value":"false"},model:{value:e.clearsettings,callback:function(t){e.clearsettings=t},expression:"clearsettings"}},[e._v("Clear Settings")])],1)],1)])],1)],1)],1)],1)],1),a("b-container",[a("b-row",{staticClass:"routes"},[a("b-col",{attrs:{sm:"12"}},[a("router-view")],1)],1)],1)],1)},o=[],r=a("2f62"),i={name:"app",created:function(){console.log("App created",this.cloudname,this.preset),this.$ls.get("cloudname")&&(this.cloudname=this.$ls.get("cloudname")),this.$ls.get("preset")&&(this.preset=this.$ls.get("preset"))},data:function(){return{cloudnameState:null,presetState:null,clearsettings:"false",expire:36e5}},computed:{cloudname:{get:function(){return this.$store.state.settings.cloudname},set:function(e){this.$store.commit("updateCloudname",e)}},preset:{get:function(){return this.$store.state.settings.preset},set:function(e){this.$store.commit("updatePreset",e)}}},methods:{checkFormValidity:function(){return!!(this.cloudname&&this.cloudname.length>0&&this.preset&&this.preset.length>0)||(this.$bvToast.toast("Enter cloudname and preset to complete form save.",{title:"Settings",autoHideDelay:5e3,appendToast:!1}),!1)},resetModal:function(){this.cloudnameState=null,this.presetState=null},handleOk:function(e){e.preventDefault(),this.handleSubmit()},handleSubmit:function(){var e=this;if("true"===this.clearsettings)return this.cloudname="",this.preset="",this.clearsettings="false",this.$ls.clear(),void this.$nextTick((function(){e.$refs.modal.hide()}));this.checkFormValidity()?(this.$ls.set("cloudname",this.cloudname,this.expire),this.$ls.set("preset",this.preset,this.expire),this.$nextTick((function(){e.$refs.modal.hide()}))):console.log("settings data not valid")}}},l=i,c=(a("034f"),a("2877")),u=Object(c["a"])(l,s,o,!1,null,null,null),d=u.exports,h=a("8c4f"),p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"home"},[a("camera")],1)},m=[],v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"camera"},[a("b-row",[a("b-col",{attrs:{sm:"12"}},[a("div",{staticClass:"actions"},[a("b-button-group",[e.cameraState?e._e():a("b-button",{attrs:{disabled:e.isStartEnabled},on:{click:e.start}},[e._v("Camera")]),e.cameraState?a("b-button",{attrs:{disabled:e.isStartEnabled},on:{click:e.stop}},[e._v("Stop")]):e._e(),e.cameraState?a("b-button",{attrs:{disabled:e.isStartEnabled},on:{click:e.snapshot}},[e._v("Snapsot")]):e._e(),e.isPhoto?a("b-button",{attrs:{disabled:!e.isPhoto},on:{click:e.download}},[e._v("Download")]):e._e(),e.isPhoto?a("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}]},[e.isPhoto?a("b-button",{attrs:{disabled:!e.isPhoto||0===e.settings.cloudname.length||0===e.settings.preset.length},on:{click:e.upload}},[e._v("Upload")]):e._e()],1):e._e()],1)],1)])],1),a("b-row",[a("b-col",{attrs:{sm:"12"}},[a("form",{},[a("b-form-select",{attrs:{options:e.options,size:"sm"},on:{change:function(t){return e.deviceChange()}},model:{value:e.selectedDevice,callback:function(t){e.selectedDevice=t},expression:"selectedDevice"}})],1)])],1),a("b-row",[a("b-col",{attrs:{sm:"12"}},[a("div",[a("video",{directives:[{name:"show",rawName:"v-show",value:e.cameraState,expression:"cameraState"}],attrs:{playsinline:"",autoplay:""}}),a("canvas",{directives:[{name:"show",rawName:"v-show",value:!e.cameraState,expression:"!cameraState"}]})])])],1)],1)},f=[],g=(a("ac4d"),a("8a81"),a("96cf"),a("ac6a"),a("3b8d")),b=a("bc3a"),y=a.n(b);function w(e,t,a){return S.apply(this,arguments)}function S(){return S=Object(g["a"])(regeneratorRuntime.mark((function e(t,a,n){var s,o,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,s=new FormData,o="https://api.cloudinary.com/v1_1/".concat(t,"/image/upload"),console.log(o),s.append("upload_preset",a),s.append("tags","browser_upload"),s.append("file",n),e.next=9,y()({method:"post",url:o,data:s});case 9:return r=e.sent,e.next=12,r.data;case 12:return e.abrupt("return",e.sent);case 15:throw e.prev=15,e.t0=e["catch"](0),console.log("error upload:",e.t0),e.t0;case 19:case"end":return e.stop()}}),e,null,[[0,15]])}))),S.apply(this,arguments)}var _={name:"Camera",data:function(){return{video:null,canvas:null,fileData:null,isStartEnabled:!0,isPhoto:!1,stream:null,currentStream:null,devices:[],options:[],constraints:{},selectedDevice:null,cameraState:!0}},computed:Object(r["b"])(["settings"]),methods:{upload:function(){var e=this;if(console.log("upload"),0===this.settings.cloudname.length||0===this.settings.preset.length)return console.log("error: upload missing cloudname or preset"),void this.$bvToast.toast("Upload to Cloudinary unsuccessful: use settings to provide cloudname and preset",{title:"Cloudinary Upload",autoHideDelay:5e3,appendToast:!1});w(this.settings.cloudname,this.settings.preset,this.fileData).then((function(t){console.log(t),e.$bvToast.toast("Upload to Cloudinary successful",{title:"Cloudinary Upload",autoHideDelay:5e3,appendToast:!1})})).catch((function(t){e.$bvToast.toast("Upload to Cloudinary unsuccessful. Check settings.",{title:"Cloudinary Upload",autoHideDelay:5e3,appendToast:!1})}))},snapshot:function(){console.log("snapshot"),this.canvas.width=this.video.videoWidth,this.canvas.height=this.video.videoHeight,this.canvas.getContext("2d").drawImage(this.video,0,0,this.canvas.width,this.canvas.height),this.fileData=this.canvas.toDataURL("image/jpeg"),this.isPhoto=!0,this.cameraState=!1},stop:function(){console.log("stop"),this.video.pause(),this.currentStream&&(this.currentStream.getTracks().forEach((function(e){e.stop()})),this.video.srcObject=null),this.video.removeAttribute("src"),this.video.load(),this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height),this.isPhoto=!1,this.cameraState=!1,console.log("end stop",this.cameraState)},start:function(){var e=this;console.log("start"),this.stop(),this.selectedDevice=this.options[0].value,this.getMedia().then((function(t){e.isStartEnabled=!1,e.cameraState=!0}))},download:function(){if(console.log("downlaod"),this.fileData){console.log("download"),this.canvas.width=this.video.videoWidth,this.canvas.height=this.video.videoHeight,this.canvas.getContext("2d").drawImage(this.video,0,0,this.canvas.width,this.canvas.height);var e=document.createElement("a");e.href=this.fileData,e.textContent="photo",e.target="_blank",e.download="photo.jpeg",document.querySelector("body").append(e),e.click()}},getMedia:function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getUserMedia(this.constraints);case 3:return this.stream=e.sent,window.stream=this.stream,this.currentStream=stream,this.video.srcObject=stream,e.abrupt("return",!0);case 10:throw e.prev=10,e.t0=e["catch"](0),e.t0;case 14:case"end":return e.stop()}}),e,this,[[0,10]])})));function t(){return e.apply(this,arguments)}return t}(),deviceChange:function(){var e=this;this.stop(),this.setConstraints(),this.getMedia().then((function(t){e.isStartEnabled=!1,e.cameraState=!0}))},setConstraints:function(){var e={};null===this.selectedDevice?e.facingMode="environment":e.deviceId={exact:this.selectedDevice},this.constraints={video:e,audio:!1}},getDevices:function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(){var t,a,n,s,o,r,i,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices){e.next=3;break}return console.log("enumerateDevices() not supported."),e.abrupt("return",!1);case 3:return e.prev=3,e.next=6,navigator.mediaDevices.enumerateDevices();case 6:for(t=e.sent,a=!0,n=!1,s=void 0,e.prev=10,o=t[Symbol.iterator]();!(a=(r=o.next()).done);a=!0)i=r.value,"videoinput"===i.kind&&(l={},l.text=i.label,l.value=i.deviceId,this.options.push(l),this.devices.push(i));e.next=18;break;case 14:e.prev=14,e.t0=e["catch"](10),n=!0,s=e.t0;case 18:e.prev=18,e.prev=19,a||null==o.return||o.return();case 21:if(e.prev=21,!n){e.next=24;break}throw s;case 24:return e.finish(21);case 25:return e.finish(18);case 26:return e.abrupt("return",!0);case 29:throw e.prev=29,e.t1=e["catch"](3),console.log("getDevices",e.t1),e.t1;case 33:console.log("devices",this.devices);case 34:case"end":return e.stop()}}),e,this,[[3,29],[10,14,18,26],[19,,21,25]])})));function t(){return e.apply(this,arguments)}return t}()},mounted:function(){var e=this;console.log("camera mounted cloudname",this.settings.cloudname),this.canvas=document.querySelector("canvas"),this.video=document.querySelector("video"),this.getDevices().then((function(t){e.selectedDevice=e.options[0].value,e.setConstraints()})).then((function(t){e.getMedia().then((function(t){e.isStartEnabled=!1}))}))}},x=_,k=(a("f5b4"),Object(c["a"])(x,v,f,!1,null,"314a2b28",null)),C=k.exports,D={name:"Home",data:function(){return{}},components:{camera:C}},$=D,O=Object(c["a"])($,p,m,!1,null,null,null),j=O.exports,P=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},E=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"gallery"}},[a("h2",[e._v("Gallery")]),a("section",{attrs:{id:"images"}})])}],T={name:"gallery",mounted:function(){this.$ls.get("cloudname")&&(this.cloudname=this.$ls.get("cloudname")),this.$ls.get("preset")&&(this.preset=this.$ls.get("preset")),this.myGallery=cloudinary.galleryWidget({container:"#images",cloudName:this.cloudname,mediaAssets:[{tag:"browser_upload"}]}),this.myGallery.render()},beforeDestroy:function(){this.myGallery.destroy},data:function(){return{myGallery:null}},computed:{cloudname:{get:function(){return this.$store.state.settings.cloudname},set:function(e){this.$store.commit("updateCloudname",e)}}}},M=T,U=a("ed39"),R=a.n(U),q=Object(c["a"])(M,P,E,!1,null,null,null);"function"===typeof R.a&&R()(q);var H=q.exports;n["default"].use(h["a"]);var G=new h["a"]({routes:[{path:"/",name:"home",component:j},{path:"/gallery",name:"gallery",component:H}]});n["default"].use(r["a"]);var I=new r["a"].Store({state:{settings:{cloudname:"",preset:""}},mutations:{updateCloudname:function(e,t){e.settings.cloudname=t},updatePreset:function(e,t){e.settings.preset=t}}}),N=I,A=a("5f5b"),F=(a("f9e3"),a("2dd8"),a("c16e")),V=a.n(F);n["default"].use(A["a"]);var W={namespace:"camera__",name:"ls",storage:"local"};n["default"].use(V.a,W),n["default"].config.productionTip=!1,new n["default"]({router:G,store:N,render:function(e){return e(d)}}).$mount("#app")},"64a9":function(e,t,a){},e04b:function(e,t,a){},ed39:function(e,t){},f5b4:function(e,t,a){"use strict";var n=a("e04b"),s=a.n(n);s.a}});
//# sourceMappingURL=app.ab15d680.js.map