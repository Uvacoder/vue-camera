(function(e){function t(t){for(var a,o,i=t[0],c=t[1],l=t[2],d=0,p=[];d<i.length;d++)o=i[d],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&p.push(s[o][0]),s[o]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);u&&u(t);while(p.length)p.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],a=!0,i=1;i<n.length;i++){var c=n[i];0!==s[c]&&(a=!1)}a&&(r.splice(t--,1),e=o(o.s=n[0]))}return e}var a={},s={app:0},r=[];function o(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=a,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(n,a,function(t){return e[t]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var u=c;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var a=n("64a9"),s=n.n(a);s.a},"1ae3":function(e,t,n){"use strict";var a=n("8b87"),s=n.n(a);s.a},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var a=n("a026"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("b-nav",[n("b-nav-item",[n("router-link",{attrs:{to:"/"}},[e._v("Camera")])],1),n("b-nav-item",[n("router-link",{attrs:{to:"/gallery"}},[e._v("Gallery")])],1),n("b-nav-item",{staticClass:"ml-auto"},[n("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:"Settings are required to upload photos."}},[n("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-prevent-closing",modifiers:{"modal-prevent-closing":!0}}],staticClass:"settings"},[n("i",{staticClass:"fas fa-cog"})]),n("b-modal",{ref:"modal",attrs:{id:"modal-prevent-closing",title:"Cloudinary Upload Info"},on:{show:e.resetModal,hidden:e.resetModal,ok:e.handleOk}},[n("form",{ref:"form",on:{submit:function(t){return t.stopPropagation(),t.preventDefault(),e.updateSettings(t)}}},[n("b-form-group",{attrs:{state:e.cloudnameState,label:"Cloudname","label-for":"cloud-name-input","invalid-feedback":"Cloudname is required"}},[n("b-form-input",{attrs:{id:"cloud-name-input",state:e.cloudnameState,required:""},model:{value:e.cloudname,callback:function(t){e.cloudname=t},expression:"cloudname"}})],1),n("b-form-group",{attrs:{state:e.presetState,label:"Preset","label-for":"preset-input","invalid-feedback":"Preset is required"}},[n("b-form-input",{attrs:{id:"preset-input",state:e.presetState,required:""},model:{value:e.preset,callback:function(t){e.preset=t},expression:"preset"}})],1),n("b-form-group",[n("b-form-checkbox",{attrs:{id:"clearsettings",name:"clearsettings",value:"true","unchecked-value":"false"},model:{value:e.clearsettings,callback:function(t){e.clearsettings=t},expression:"clearsettings"}},[e._v("Clear Settings")])],1)],1)])],1)])],1),n("router-view")],1)},r=[],o=n("2f62"),i={name:"app",created:function(){console.log("App created",this.cloudname,this.preset)},data:function(){return{cloudnameState:null,presetState:null,clearsettings:"false",expire:36e5}},computed:{cloudname:{get:function(){return this.$store.state.settings.cloudname},set:function(e){this.$store.commit("updateCloudname",e)}},preset:{get:function(){return this.$store.state.settings.preset},set:function(e){this.$store.commit("updatePreset",e)}}},methods:{checkFormValidity:function(){return!0},resetModal:function(){this.cloudnameState=null,this.presetState=null},handleOk:function(e){e.preventDefault(),this.handleSubmit()},handleSubmit:function(){var e=this;if("true"===this.clearsettings)return this.cloudname="",this.preset="",this.clearsettings="false",void this.$nextTick((function(){e.$refs.modal.hide()}));this.checkFormValidity()?this.$nextTick((function(){e.$refs.modal.hide()})):console.log("settings data not valid")}}},c=i,l=(n("034f"),n("2877")),u=Object(l["a"])(c,s,r,!1,null,null,null),d=u.exports,p=n("8c4f"),h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[n("camera")],1)},v=[],f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"camera"},[n("div",[n("b-button-group",[n("b-button",{attrs:{disabled:!e.isStartEnabled},on:{click:e.start}},[e._v("Start")]),n("b-button",{attrs:{disabled:e.isStartEnabled},on:{click:e.stop}},[e._v("Stop")]),n("b-button",{attrs:{disabled:e.isStartEnabled},on:{click:e.snapshot}},[e._v("Snapsot")]),n("b-button",{attrs:{disabled:!e.isPhoto},on:{click:e.download}},[e._v("Downlolad")]),n("b-button",{attrs:{disabled:!e.isPhoto||0===e.settings.cloudname.length||0===e.settings.preset.length},on:{click:e.upload}},[e._v("Upload")])],1)],1),n("form",{},[n("b-form-select",{attrs:{options:e.options,size:"sm"},on:{change:function(t){return e.setConstraints()}},model:{value:e.selectedDevice,callback:function(t){e.selectedDevice=t},expression:"selectedDevice"}})],1),e._m(0)])},m=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"container"}},[n("video",{attrs:{playsinline:"",autoplay:""}}),n("canvas")])}],g=(n("ac4d"),n("8a81"),n("96cf"),n("ac6a"),n("3b8d")),b=n("bc3a"),y=n.n(b);function w(e,t,n){return x.apply(this,arguments)}function x(){return x=Object(g["a"])(regeneratorRuntime.mark((function e(t,n,a){var s,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,s=new FormData,s.append("upload_preset",n),s.append("tags","browser_upload"),s.append("file",a),e.next=7,y()({method:"post",url:"https://api.cloudinary.com/v1_1/".concat(t,"/upload"),data:s});case 7:return r=e.sent,e.next=10,r.data;case 10:return e.abrupt("return",e.sent);case 13:e.prev=13,e.t0=e["catch"](0),console.log("error upload:",e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])}))),x.apply(this,arguments)}var S={name:"Camera",data:function(){return{video:null,canvas:null,fileData:null,isStartEnabled:!0,isPhoto:!1,stream:null,currentStream:null,devices:[],options:[],constraints:{},selectedDevice:"0"}},computed:Object(o["b"])(["settings"]),methods:{upload:function(){if(console.log("upload"),0===this.settings.cloudname.length||0===this.settings.preset.length)return console.log("error: upload missing cloudname or preset"),void this.$bvToast.toast("Upload to Cloudinary unsuccessful: use settings to provide cloudname and preset",{title:"Cloudinary Upload",autoHideDelay:5e3,appendToast:!1});w(this.settings.cloudname,this.settings.preset,this.fileData);this.$bvToast.toast("Upload to Cloudinary successful",{title:"Cloudinary Upload",autoHideDelay:5e3,appendToast:!1})},snapshot:function(){console.log("snapshot"),this.canvas.width=this.video.videoWidth,this.canvas.height=this.video.videoHeight,this.canvas.getContext("2d").drawImage(this.video,0,0,this.canvas.width,this.canvas.height),this.fileData=this.canvas.toDataURL("image/jpeg"),this.isPhoto=!0},stop:function(){console.log("stop"),this.video.pause(),this.currentStream&&(this.currentStream.getTracks().forEach((function(e){e.stop()})),this.video.srcObject=null),this.video.removeAttribute("src"),this.video.load(),this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height),this.isStartEnabled=!0,this.isPhoto=!1},start:function(){console.log("start"),this.stop(),this.getMedia(),this.isStartEnabled=!1},download:function(){if(console.log("downlaod"),this.fileData){console.log("download"),this.canvas.width=this.video.videoWidth,this.canvas.height=this.video.videoHeight,this.canvas.getContext("2d").drawImage(this.video,0,0,this.canvas.width,this.canvas.height);var e=document.createElement("a");e.href=this.fileData,e.textContent="photo",e.target="_blank",e.download="photo.jpeg",document.querySelector("body").append(e),e.click()}},getMedia:function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getUserMedia(this.constraints);case 3:this.stream=e.sent,window.stream=this.stream,this.currentStream=stream,this.video.srcObject=stream,e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](0),console.log("getmedia",e.t0);case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));function t(){return e.apply(this,arguments)}return t}(),setConstraints:function(){var e={};"0"===this.selectedDevice?e.facingMode="environment":e.deviceId={exact:this.selectedDevice.value},this.constraints={video:e,audio:!1}},getDevices:function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(){var t,n,a,s,r,o,i,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices){e.next=3;break}return console.log("enumerateDevices() not supported."),e.abrupt("return");case 3:return e.prev=3,e.next=6,navigator.mediaDevices.enumerateDevices();case 6:for(t=e.sent,n=!0,a=!1,s=void 0,e.prev=10,r=t[Symbol.iterator]();!(n=(o=r.next()).done);n=!0)i=o.value,"videoinput"===i.kind&&(c={},c.text=i.label,c.value=i.deviceId,this.options.push(c),this.devices.push(i));e.next=18;break;case 14:e.prev=14,e.t0=e["catch"](10),a=!0,s=e.t0;case 18:e.prev=18,e.prev=19,n||null==r.return||r.return();case 21:if(e.prev=21,!a){e.next=24;break}throw s;case 24:return e.finish(21);case 25:return e.finish(18);case 26:this.options.length<3&&(this.selectedDevice=this.options[1].value),e.next=32;break;case 29:e.prev=29,e.t1=e["catch"](3),console.log("getDevices",e.t1);case 32:console.log("devices",this.devices);case 33:case"end":return e.stop()}}),e,this,[[3,29],[10,14,18,26],[19,,21,25]])})));function t(){return e.apply(this,arguments)}return t}()},mounted:function(){console.log("camera mounted cloudname",this.settings.cloudname),this.canvas=document.querySelector("canvas"),this.video=document.querySelector("video"),this.options.push({text:"Select Device",value:0}),this.getDevices(),this.setConstraints(),this.getMedia(),this.isStartEnabled=!1}},k=S,_=(n("1ae3"),Object(l["a"])(k,f,m,!1,null,"752db243",null)),D=_.exports,C={name:"Home",data:function(){return{}},components:{camera:D}},O=C,j=(n("5729"),Object(l["a"])(O,h,v,!1,null,"095759b6",null)),$=j.exports,P=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},E=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"gallery"}},[n("h2",[e._v("Gallery")])])}],M={name:"gallery",mounted:function(){this.cloudname=this.$ls.get("cloudname"),this.preset=this.$ls.get("preset")},data:function(){return{cloudname:"",presest:""}}},T=M,q=Object(l["a"])(T,P,E,!1,null,null,null),R=q.exports;a["default"].use(p["a"]);var U=new p["a"]({routes:[{path:"/",name:"home",component:$},{path:"/gallery",name:"gallery",component:R}]});a["default"].use(o["a"]);var H=new o["a"].Store({state:{settings:{cloudname:"",preset:""}},mutations:{updateCloudname:function(e,t){e.settings.cloudname=t},updatePreset:function(e,t){e.settings.preset=t}}}),I=H,F=n("5f5b"),A=(n("f9e3"),n("2dd8"),n("c16e")),G=n.n(A);a["default"].use(F["a"]);var J={namespace:"vuejs__"};a["default"].use(G.a,J),a["default"].config.productionTip=!1,new a["default"]({router:U,store:I,render:function(e){return e(d)}}).$mount("#app")},5729:function(e,t,n){"use strict";var a=n("c54b"),s=n.n(a);s.a},"64a9":function(e,t,n){},"8b87":function(e,t,n){},c54b:function(e,t,n){}});
//# sourceMappingURL=app.5020aeed.js.map